{% extends "base.html" %}

{% block title %}
OTP Verification
{% endblock %}

{% block content %}
<div class="otp-verification form">
    <header>Verify OTP</header>
    <form id="otp-form" action="#" method="POST">
        <input type="text" name="otp" placeholder="Enter your OTP" required>
        <input type="submit" class="button" value="Verify">
    </form>

    <div class="timer">
        <p>OTP expires in: <span id="countdown"></span></p>
    </div>
</div>

<script>
  
    let countdownTime = 3 * 60; 
 
    
    function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
    }

    function startCountdown() {
        const countdownElement = document.getElementById('countdown');
        const otpForm = document.getElementById('otp-form');

        const timerInterval = setInterval(() => {
            countdownTime--;

            countdownElement.textContent = formatTime(countdownTime);

            if (countdownTime <= 0) {
                clearInterval(timerInterval); // Stop the timer
                
                otpForm.querySelector('input[type="submit"]').disabled = true;
                otpForm.querySelector('input[name="otp"]').disabled = true;

                countdownElement.textContent = "OTP expired!";
                setTimeout(() => {
                    window.location.href = "{{ url_for('register') }}"; // Redirect to register page
                }, 2000); 
            }
        }, 1000); 
    }

  
    document.addEventListener('DOMContentLoaded', startCountdown);
</script>
{% endblock %}
